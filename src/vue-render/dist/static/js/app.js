webpackJsonp([1],{"+hAf":function(e,t){},"09yM":function(e,t){},"0CLL":function(e,t){},"DW+F":function(e,t){},DW1S:function(e,t){},NHnr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("kV13"),n={name:"Menu",components:{},props:{},data:function(){return{isCollapse:!1}},methods:{handleOpen:function(e,t){console.log(e,t)},handleClose:function(e,t){console.log(e,t)}},watch:{},filters:{},mounted:function(){}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Menu"},[a("el-menu",{attrs:{"default-active":"/GenTrade","default-openeds":["/GenTrade"],collapse:e.isCollapse,router:""}},[a("el-submenu",{attrs:{index:"1"}},[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-s-tools"}),e._v(" "),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("工具")])]),e._v(" "),a("el-menu-item",{attrs:{index:"/GenTrade"}},[e._v("生成交易")]),e._v(" "),a("el-menu-item",{attrs:{index:"/GenPrintF"}},[e._v("生成打印F表")]),e._v(" "),a("el-menu-item",{attrs:{index:"/GenInterface"}},[e._v("生成接口")])],2)],1)],1)},staticRenderFns:[]};var i={name:"App",components:{Menu:a("C7Lr")(n,l,!1,function(e){a("yfIn")},"data-v-69219a49",null).exports},data:function(){return{menuWidth:200}},computed:{left:function(){return this.menuWidth-200}},methods:{func:function(e){this.menuWidth=e?0:200}}},s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("div",{staticClass:"menu",style:{left:e.left+"px"}},[a("Menu")],1),e._v(" "),a("div",{staticClass:"tools-container",style:{marginLeft:e.menuWidth+"px"}},[a("router-view"),e._v(" "),a("i",{directives:[{name:"show",rawName:"v-show",value:200==e.menuWidth,expression:"menuWidth==200"}],staticClass:"el-icon-d-arrow-left handle-icon",on:{click:function(t){return e.func(!0)}}}),e._v(" "),a("i",{directives:[{name:"show",rawName:"v-show",value:0==e.menuWidth,expression:"menuWidth==0"}],staticClass:"el-icon-d-arrow-right handle-icon",on:{click:function(t){return e.func(!1)}}})],1)])},staticRenderFns:[]};var o=a("C7Lr")(i,s,!1,function(e){a("DW+F")},"data-v-956f53a0",null).exports,u=a("7LQH"),c={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"Home"},[t("div",[this._v("home")])])}]};var d=a("C7Lr")({name:"Home",components:{},props:{},data:function(){return{}},methods:{},watch:{},filters:{},mounted:function(){}},c,!1,function(e){a("iWT2")},"data-v-551d7287",null).exports,p=a("ZLEe"),m=a.n(p),f=a("rVsN"),v=a.n(f),h=a("3cXf"),b=a.n(h),g=a("lC5x"),A=a.n(g),_=a("J0Oq"),w=a.n(_),N=a("x7Ey"),C=a.n(N);var x={fetchStandardFields:function(){var e={SYS_HEAD:{BIZ_FOLN_NO:"",SYS_FOLN_NO:"",CLIENT_TYP:"110064",BIZ_ACCESS_CHNL_CD:"0101",SCENE_CD:"DBComm",SERV_PTY_PROD_CD:"067",SERV_CD:"DB",REQE_PTY_PROD_CD:"066",REQE_PTY_REQE_TS:"2020-01-10 19:14:03.966",REQE_PTY_IP:"20.3.15.151",RequestDate:"20200110",RequestTime:"191403",BagSeqNo:"",AppNum:"TE",Reserve:""},APP_HEAD:{UserNum:"204217",UserName:"俸馨",BranchNum:"2039",BranchName:"四川广汉农村商业银行股份有限公司对公专柜",DvcNum:"",MacValue:"8C-EC-4B-B7-10-91",DeviceNum:"",DeviceModel:"",Tlr:"",AhrTlr:"",AhrTaskNum:"",AhrBrah:"",chcekTlr:"",LUNCH_EMPNBR:"",checkOrgNo:"",BsnTranCode:"",FictTellerNum:"",LegalPersonNum:"2105",TranCode:"",TranNm:""},Body:{CommCode:"DB",SceneCode:"DBComm",TradeData:'{"_busidatakey_":"queryStandardFields","PB_PRIVATE_KEY":"000000000000000A"}'}},t={BranchNum:"2039",ConsumerId:"066",ConsumerIP:"20.3.15.151","Content-Type":"application/json",LegalNum:"2105",Origin:"http://localhost:53008",Referer:"http://localhost:53008/FCClient/modules/frame/custom-service/index.html",Reserve:"",TraceId:"01157865416332746708","User-Agent":"Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.95 Safari/537.36",UserNum:"204217","X-AmebaCloud-RandomNumber":"0.1513719200156629","X-AmebaCloud-VerifyTime":"1578654163332"};return new v.a(function(a){var r=window.standardFields;r?a({isSuccess:!0,data:r}):C()({method:"post",url:"http://10.16.2.228/abside/abs-ib-dbcomm/dbComm",headers:t,data:e}).then(function(t){if("000000"==(t=t.data).OutArgs.errorcode){var r=JSON.parse(t.result.Rslt).Result.map(function(e){var t={};try{t=new Function("return "+(e.COMP_DESC||"{}"))()}catch(t){alert("解析JSON出错"+e.COMP_DESC)}return{label:e.COLM_DESC,value:e.COLM_NM,isFullRow:e.DGIT>60,tagName:e.COMP_TAG,compAttr:t}});window.standardFields=r,a({isSuccess:!0,data:r})}else a({isSuccess:!1,data:e})}).catch(function(e){a({isSuccess:!1,data:[]})})})},queryAllStandardFields:function(){var e={SYS_HEAD:{BIZ_FOLN_NO:"",SYS_FOLN_NO:"",CLIENT_TYP:"110064",BIZ_ACCESS_CHNL_CD:"0101",SCENE_CD:"DBComm",SERV_PTY_PROD_CD:"067",SERV_CD:"DB",REQE_PTY_PROD_CD:"066",REQE_PTY_REQE_TS:"2020-01-10 19:14:03.966",REQE_PTY_IP:"20.3.15.151",RequestDate:"20200110",RequestTime:"191403",BagSeqNo:"",AppNum:"TE",Reserve:""},APP_HEAD:{UserNum:"204217",UserName:"俸馨",BranchNum:"2039",BranchName:"四川广汉农村商业银行股份有限公司对公专柜",DvcNum:"",MacValue:"8C-EC-4B-B7-10-91",DeviceNum:"",DeviceModel:"",Tlr:"",AhrTlr:"",AhrTaskNum:"",AhrBrah:"",chcekTlr:"",LUNCH_EMPNBR:"",checkOrgNo:"",BsnTranCode:"",FictTellerNum:"",LegalPersonNum:"2105",TranCode:"",TranNm:""},Body:{CommCode:"DB",SceneCode:"DBComm",TradeData:'{"_busidatakey_":"queryAllStandardFields","PB_PRIVATE_KEY":"000000000000000A"}'}},t={BranchNum:"2039",ConsumerId:"066",ConsumerIP:"20.3.15.151","Content-Type":"application/json",LegalNum:"2105",Origin:"http://localhost:53008",Referer:"http://localhost:53008/FCClient/modules/frame/custom-service/index.html",Reserve:"",TraceId:"01157865416332746708","User-Agent":"Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.95 Safari/537.36",UserNum:"204217","X-AmebaCloud-RandomNumber":"0.1513719200156629","X-AmebaCloud-VerifyTime":"1578654163332"};return new v.a(function(a){var r=window.standardFields;r?a({isSuccess:!0,data:r}):C()({method:"post",url:"http://10.16.2.228/abside/abs-ib-dbcomm/dbComm",headers:t,data:e}).then(function(t){if("000000"==(t=t.data).OutArgs.errorcode){var r=JSON.parse(t.result.Rslt).Result.map(function(e){return{label:e.COLM_DESC,value:e.COLM_NM,isFullRow:e.DGIT>60}});window.standardFields=r,a({isSuccess:!0,data:r})}else a({isSuccess:!1,data:e})}).catch(function(e){a({isSuccess:!1,data:[]})})})},getParentMenuInfo:function(){var e={SYS_HEAD:{BIZ_FOLN_NO:"",SYS_FOLN_NO:"",CLIENT_TYP:"110064",BIZ_ACCESS_CHNL_CD:"0101",SCENE_CD:"DBComm",SERV_PTY_PROD_CD:"067",SERV_CD:"DB",REQE_PTY_PROD_CD:"066",REQE_PTY_REQE_TS:"2020-01-10 19:14:03.966",REQE_PTY_IP:"20.3.15.151",RequestDate:"20200110",RequestTime:"191403",BagSeqNo:"",AppNum:"TE",Reserve:""},APP_HEAD:{UserNum:"204217",UserName:"俸馨",BranchNum:"2039",BranchName:"四川广汉农村商业银行股份有限公司对公专柜",DvcNum:"",MacValue:"8C-EC-4B-B7-10-91",DeviceNum:"",DeviceModel:"",Tlr:"",AhrTlr:"",AhrTaskNum:"",AhrBrah:"",chcekTlr:"",LUNCH_EMPNBR:"",checkOrgNo:"",BsnTranCode:"",FictTellerNum:"",LegalPersonNum:"2105",TranCode:"",TranNm:""},Body:{CommCode:"DB",SceneCode:"DBComm",TradeData:'{"_busidatakey_":"getParentMenuInfo","PB_PRIVATE_KEY":"000000000000000A"}'}},t={BranchNum:"2039",ConsumerId:"066",ConsumerIP:"20.3.15.151","Content-Type":"application/json",LegalNum:"2105",Origin:"http://localhost:53008",Referer:"http://localhost:53008/FCClient/modules/frame/custom-service/index.html",Reserve:"",TraceId:"01157865416332746708","User-Agent":"Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.95 Safari/537.36",UserNum:"204217","X-AmebaCloud-RandomNumber":"0.1513719200156629","X-AmebaCloud-VerifyTime":"1578654163332"};return new v.a(function(a){window.parentMenuInfo?a({isSuccess:!0,data:window.parentMenuInfo}):C()({method:"post",url:"http://10.16.2.228/abside/abs-ib-dbcomm/dbComm",headers:t,data:e}).then(function(e){if("000000"==(e=e.data).OutArgs.errorcode){var t=JSON.parse(e.result.Rslt).Result;window.parentMenuInfo=t,a({isSuccess:!0,data:t})}else a({isSuccess:!1,data:[]})}).catch(function(e){a({isSuccess:!1,data:[]})})})}},S=[{name:"v-model",attrPosition:"data"},{name:"paraFile",attrPosition:"tag",value:""},{name:"listName",attrPosition:"tag",value:""},{name:":success",attrPosition:"methods",args:["name","age"]}],T=(JSON.parse(b()(S)),JSON.parse(b()(S)),JSON.parse(b()(S)),JSON.parse(b()(S)),[{groupTitle:"客户信息",label:"IMEI序列号",":requisite":"true"},{groupTitle:"客户信息",label:"SIM卡序列号",":requisite":"true"},{groupTitle:"客户信息",label:"保证金金额",":requisite":"true"},{groupTitle:"客户信息1",label:"保证金账号",":requisite":"true"},{groupTitle:"客户信息1",label:"保证金账户标志",":requisite":"true"}]),F={getStandardConfig:function(e){var t=this;return w()(A.a.mark(function e(){var a;return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.fetchStandardFields();case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}},e,t)}))()},transformExcelData:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:JSON.parse(b()(T)),r=a.map(function(e){return e.groupTitle});return r=(r=r.filter(function(e,t){return r.indexOf(e)==t})).map(function(e,t){return{groupTitle:e,groupId:t}}),a.forEach(function(e){var t=r.find(function(t){return t.groupTitle==e.groupTitle});e.groupId=t.groupId}),{excelData:a,msgs:this.findEnFieldName(e,t,a).msgs}},findEnFieldName:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=[],n=function(e){var n=a[e],l=t.find(function(e){return e.label==n.label});if(l){n.value=l.value,n.compAttr=l.compAttr,n.isFullRow=l.isFullRow,n.tagName=l.tagName;for(var i=0;i<n.compAttr.length;i++){var s=l.compAttr[i];if("methods"==s.attrPosition){var o=s.name.replace(/:/g,"").toLocaleLowerCase();o=o.charAt(0).toUpperCase()+o.substr(1);var u=""+l.value+o;s.value=u}else"data"==s.attrPosition&&"v-model"==s.name&&(s.value=l.value);["paraFile","listName"].includes(s.name)&&(s.listNameOptions=[])}var c=n.compAttr;n.tagName;if(n.hasOwnProperty(":requisite")&&c.push({name:":requisite",attrPosition:"tag",value:n[":requisite"]}),n.hasOwnProperty(":disabled")){var d=n.compAttr.find(function(e){return":disabled"==e.name});d?d.value=n[":disabled"]:c.push({name:":disabled",attrPosition:"tag",value:n[":disabled"]})}if(n.hasOwnProperty(":readonly")){var p=n.compAttr.find(function(e){return":readonly"==e.name});p?p.value=n[":readonly"]:c.push({name:":readonly",attrPosition:"tag",value:n[":readonly"]})}if(n.hasOwnProperty(":visible")){var m=n.compAttr.find(function(e){return":visible"==e.name});m?m.value=n[":visible"]:c.push({name:":visible",attrPosition:"tag",value:n[":visible"]})}var f={name:"ref",value:n.value,attrPosition:"tag"},v={name:"property",value:n.value,attrPosition:"tag"},h={name:"label",value:n.label,attrPosition:"tag"};c.splice(1,0,v),c.splice(1,0,f),c.splice(1,0,h);c.find(function(e){return"ref"==e.name}),c.find(function(e){return"property"==e.name}),c.find(function(e){return"label"==e.name})}else r.push(n.label)},l=0;l<a.length;l++)n(l);return{msgs:r}}},y=a("89ll"),E=a.n(y);function R(e,t){var a=[],r=[];if(t.compAttr.every(function(e){return Boolean(e.attrPosition)})){for(var n=0;n<t.compAttr.length;n++){var l=t.compAttr[n];"methods"==l.attrPosition?a.push({name:l.name,args:l.args,value:l.value}):"data"==l.attrPosition&&("v-model"==l.name?(l.value="TradeData."+t.value,r.push(t.value)):r.push(l.value))}!function(e,t){var a=t.compAttr,r=t.tagName,n=[":visible"],l="<"+r+" "+(a=(a=a.filter(function(e){return!1===e.value?!!n.includes(e.name)&&!e.value:Boolean(e.value)})).map(function(e){return e.name+'="'+e.value+'"'})).join(" ")+"></"+r+">";t.compTpl=l}(0,t)}else e.alert("<p>有属性没有attrPosition"+b()(t)+"</p>");return{methods:a,dataFields:r}}var D={genAll:function(e,t){var a=function(e,t){for(var a=[],r=[],n=0;n<t.length;n++){var l=t[n];if("custom-table"==l.tagName){var i={tplStr:[],methods:[],dataFields:[]},s=i.methods,o=i.dataFields;a=a.concat(s),r=r.concat(o)}else{var u=R(e,l),c=u.methods,d=u.dataFields;a=a.concat(c),r=r.concat(d)}}return{standardFields:t,methodsAll:a=function(e,t){return t=t.map(function(e){return"async "+e.value+"("+(e.args||[]).join(",")+"){}"})}(0,a),dataFieldsAll:r}}(e,t);return{excelFieldsAll:a.standardFields,methodsAll:a.methodsAll,dataFieldsAll:a.dataFieldsAll}},twoDimensionalArray:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=[],r=E.a.groupBy(t,function(e){return e.groupId}),n=Math.max.apply(null,m()(r)),l=0;l<=n;l++)a.push(r[l]);return a=a.map(function(e){return function(e){for(var t=[],a=0;a<e.length;a++){var r=e[a];if(0==t.length)t.push([r]);else{var n=t[t.length-1],l=n[n.length-1];2==n.length?t.push([r]):l.isFullRow?t.push([r]):n.push(r)}}return t}(e)})},handleTableInfo:function(e,t){for(var a=[],r=[],n=[],l=[],i=e.map(function(e){return e.label.split("|").filter(function(e){return e})}),s=0;s<i.length;s++)for(var o=function(e){var r=i[s][e];t.find(function(e){return e.label==r})||a.push(r)},u=0;u<i[s].length;u++)o(u);return 0!=a.length?{tMsgs:a,tMethods:r,tDataFields:n,tableTpls:l}:(i.map(function(e){return e.map(function(e){var a=t.find(function(t){return t.label==e});return{label:a.label,value:a.value}})}).forEach(function(e,t){var a=e.map(function(e){return{label:e.label,prop:e.value,type:"input"}});n.push({label:"tableHeadData"+t,value:b()(a)}),n.push({label:"tableData"+t,value:b()([])}),n.push({label:"btnGroup"+t,value:b()([])});var r='<custom-table ref="customTable'+t+'" :tableHeadData="tableHeadData'+t+'" :tableData="tableData'+t+'" :btnGroup="btnGroup'+t+'"/>';l.push(r)}),{tMsgs:a,tMethods:r,tDataFields:n,tableTpls:l})}},k=window.m.xlsx,P=function(e,t){var a=document.createElement("a");a.download=t;var r=URL.createObjectURL(e);a.href=r,a.click(),setTimeout(function(){URL.revokeObjectURL(r)},100)},O=function(e){if("undefined"!=typeof ArrayBuffer){for(var t=new ArrayBuffer(e.length),a=new Uint8Array(t),r=0;r!=e.length;++r)a[r]=255&e.charCodeAt(r);return t}for(t=new Array(e.length),r=0;r!=e.length;++r)t[r]=255&e.charCodeAt(r);return t};var L={readExcelAsync:function(e){return new v.a(function(t,a){try{var r=new FileReader(e);r.onload=function(e){var a=k.read(e.target.result,{type:"binary"}),r={};a.SheetNames.forEach(function(e){var t=a.Sheets[e],n=k.utils.sheet_to_json(t,{header:"A",blankrows:!1,defval:""});r[e]=n}),t({isSuccess:!0,data:r})},r.readAsBinaryString(e)}catch(e){t({isSuccess:!1,errorcode:e.name,msg:e.message})}})},exportJsonToExcel:function(e,t){new Date;var a={SheetNames:["Sheet1"],Sheets:{},Props:{}};a.Sheets.Sheet1=k.utils.json_to_sheet(e),a.Sheets.Sheet1["!cols"]=[{wch:30},{wch:20},{wch:40},{wch:20}],t=t||"模板.xls",P(new Blob([O(k.write(a,{bookType:"xlsx",bookSST:!1,type:"binary"}))],{type:"application/octet-stream"}),t)}},M={name:"GenTrade",data:function(){return{titleRule:[{required:!0,message:"不能为空"}],tradeAttrArea:{tradeRoot:"E:\\work\\zantong\\qdgz_TEClient\\FCClient",devGroup:"asu-test",devGroupChild:"",tradeCode:"00101001",tradeName:"测试交易生成",userName:"",email:"",tradeCodeBiz:"010101",menuPosition:"001",menuIcon:"inner-gird-maintain.svg",parentMenu:"0101",visiable:"1",signVisiable:"1"},devGroupOptionsChild:[],devGroupOptions:[{label:"测试-asu-test",value:"asu-test"}],collapseValues:[],collapseValuesButtom:[],rules:[{type:"any"}],tplsStr:"",excelFieldsAll:[{groupId:0,groupTitle:"客户信息",isFullRow:!1,compTpl:"<div></div>"}],methodsAll:[],distTplData:[],standardFields:[],standardFieldsButtom:[],excelDataRender:[],paraFileOptions:[],tMethods:[],tDataFields:[],tableTpls:[],buttomArea:[],excelData:[],cascaderGroup:[],cascaderGroupOptions:[{label:"label1",value:"value1",children:[{label:"ddd",value:"vvv"}]}],iconsOptions:[{label:"inner-gird-maintain.svg",value:"inner-gird-maintain.svg"},{label:"inner-grid-01.png",value:"inner-grid-01.png"},{label:"icon_trade_debt.png",value:"icon_trade_debt.png"},{label:"icon_trade_other.png",value:"icon_trade_other.png"},{label:"icon_trade_dayend.png",value:"icon_trade_dayend.png"},{label:"icon_trade_feature.png",value:"icon_trade_feature.png"},{label:"icon_trade_default.png",value:"icon_trade_default.png"},{label:"inner-gird-finance.svg",value:"inner-gird-finance.svg"},{label:"inner-gird-query.svg",value:"inner-gird-query.svg"},{label:"inner-gird-other.svg",value:"inner-gird-other.svg"},{label:"icon_trade_inside.png",value:"icon_trade_inside.png"},{label:"inner-grid-04.png",value:"inner-grid-04.png"},{label:"inner-grid-other.svg",value:"inner-grid-other.svg"},{label:"inner-grid-03.png",value:"inner-grid-03.png"}],parentMenuOptions:[],dialogVisiable:!1,menuSqlStr:""}},methods:{saveTmpExcel:function(){L.exportJsonToExcel([{"组名称(trade-group)":""},{"栏位名称":""},{"必输(Q)|不可用(D)|只读(R)|不可见(V)":""}],"生成交易模板.xls")},chooseExcel:function(){this.tradeRootChange()&&(this.fetchParaFileOptions(),this.$refs.inputFile.value="",this.$refs.inputFile.click())},inputFileChange:function(e){var t=this;return w()(A.a.mark(function a(){var r,n,l,i,s;return A.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(r=e.target.files[0],r.path,n=window.m.path.extname(r.path),[".xls",".xlsx"].includes(n)){a.next=6;break}return t.$notify({message:"必须是excel"}),a.abrupt("return");case 6:return a.next=8,L.readExcelAsync(r);case 8:l=a.sent,i=l.data.Sheet1.slice(1),s=i.map(function(e){var t=String(e.C).toUpperCase(),a=t.includes("Q"),r=t.includes("D"),n=t.includes("R"),l=t.includes("V"),i={groupTitle:e.A,label:e.B,":requisite":a,":disabled":r,":readonly":n,":visible":!l};return i[":visible"]&&delete i[":visible"],i}),t.parseExcel(s);case 12:case"end":return a.stop()}},a,t)}))()},calcCollapseValues:function(){var e=this.excelData.map(function(e){if(!e.compAttr.every(function(e){return""!==e.value&&void 0!==e.value}))return e.label});this.collapseValues=e.filter(function(e){return e})},genStandardField:function(){var e=this;return w()(A.a.mark(function t(){var a;return A.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,F.getStandardConfig(e);case 2:if((a=t.sent).isSuccess){t.next=6;break}return e.$notify({title:a.msg,duration:0}),t.abrupt("return");case 6:e.standardFields=JSON.parse(b()(a.data)),e.standardFieldsButtom=JSON.parse(b()(a.data));case 8:case"end":return t.stop()}},t,e)}))()},parseExcel:function(e){var t=(e=e.map(function(e){return e.groupTitle.trim()||(e.groupTitle="默认分组"),e})).filter(function(e){return e.label.includes("|")}),a=D.handleTableInfo(t,this.standardFields),r=a.tMsgs,n=a.tMethods,l=a.tDataFields,i=a.tableTpls;this.tMethods=n,this.tDataFields=l,this.tableTpls=i;var s=(e=e.filter(function(e){return!e.label.includes("|")})).findIndex(function(e){return"提交"==e.label.trim()});-1==s&&(s=e.length);var o=e.slice(s+1,e.length);e=e.slice(0,s);var u=F.transformExcelData(this,this.standardFields,e),c=u.excelData,d=u.msgs;if((d=d.concat(r)).length>0){(d=d.map(function(e){return" "+e+" "})).unshift('<div style="font-weight:bold;font-size:17px;">请联系标准组添加以下字段后再生成交易</div>');var p=d.join("");this.alert(p,"提示")}else{var m=F.transformExcelData(this,this.standardFieldsButtom,o),f=m.excelData,v=m.msgs;if(v.length>0){(v=v.map(function(e){return" "+e+" "})).unshift('<div style="font-weight:bold;font-size:17px;">请联系标准组添加以下字段后再生成交易</div>');var h=v.join("");this.alert(h,"提示")}else this.excelData=[],this.excelData=c,this.calcCollapseValues(),this.buttomArea=[],this.buttomArea=f,this.excelDataRender=this.excelData.concat(this.buttomArea)}},genTradeTpl:function(){var e=this;return w()(A.a.mark(function t(){var a,r,n,l,i,s,o,u,c,d;return A.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.validateForm();case 2:if(t.sent){t.next=6;break}return e.$notify({type:"warning",message:"交易属性填完"}),t.abrupt("return");case 6:if(0!=e.excelDataRender.length){t.next=9;break}return e.$notify({type:"warning",message:"先导入统计的excel"}),t.abrupt("return");case 9:a=D.genAll(e,e.excelData),r=a.excelFieldsAll,n=a.methodsAll,l=a.dataFieldsAll,r=r.map(function(e){return{groupId:e.groupId,groupTitle:e.groupTitle,isFullRow:e.isFullRow,compTpl:e.compTpl}}),i=D.genAll(e,e.buttomArea),s=i.excelFieldsAll,o=i.methodsAll,u=i.dataFieldsAll,s=s.map(function(e){return{groupId:e.groupId,groupTitle:e.groupTitle,isFullRow:e.isFullRow,compTpl:e.compTpl}}),c=D.twoDimensionalArray(e,r),d=D.twoDimensionalArray(e,s),n=n.concat(o),l=(l=l.concat(u)).filter(function(e,t){return l.indexOf(e)==t}),n=n.filter(function(e,t){return n.indexOf(e)==t}),e.writeToFile({distTplData:c,distTplDataB:d,methodsAll:n,dataFieldsAll:l});case 23:case"end":return t.stop()}},t,e)}))()},gentTradeMenu:function(){var e=this;return w()(A.a.mark(function t(){var a,r,n,l,i,s,o,u,c,d,p,m,f;return A.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.validateForm();case 2:if(t.sent){t.next=6;break}return e.$notify({type:"warning",message:"交易属性填完"}),t.abrupt("return");case 6:a=e.tradeAttrArea.menuPosition,r=e.tradeAttrArea.tradeCode,n=e.tradeAttrArea.tradeName,l=e.tradeAttrArea.menuIcon,"",i=e.tradeAttrArea.parentMenu,s="1"==e.tradeAttrArea.visiable?"1":"0",o="1"==e.tradeAttrArea.signVisiable?"1":"0",u=e.tradeAttrArea.tradeCodeBiz,c=e.tradeAttrArea.tradeName,d=e.tradeAttrArea.devGroup,p=e.tradeAttrArea.devGroupChild?"/"+e.tradeAttrArea.devGroupChild:"",m="/t"+e.tradeAttrArea.tradeCode,f="INSERT INTO `pub_db`.`IB_UPM_MENU_INFO`(`APP_NO`, `MENU_VIEW_NO`, `MENU_NO`, `MENU_NM`, `MENU_ICON_PATH`, `MENU_PATH`, `MENU_TYP_CD`, `QUNG_SEQ_NO`, `PARE_RANK_MENU_NO`, `VIS_FLG`, `SYNC_ASYNC_FLG`, `BLNG_LPR_CD`, `MATN_ORG_NO`, `MATN_TM`, `MATN_DT`, `REMRK_1`, `REMRK_2`, `REMRK_3`, `MATN_TELR_NO`, `SGNIN_VIS_FLG_CD`, `CLNT_MENU_FLG`, `IS_BPMN_FLG`, `MENU_SIZE`, `ACTIVE_CLASS`, `BCKGRND_COLR_CD`, `BCKGRND_PICT_PATH`, `LAYOUT_ROW`, `LAYOUT_COL`, `MENU_ENG_NM`, `BIZ_MENU_NO`, `BIZ_MENU_NM`, `STRK_BAL_FLG`, `NEED_PR_ELEC_SIGNET_FLG`, `UPLDG_ATCH_FLG`) VALUES ('TE', '"+a+"', '"+r+"', '"+n+"', '"+l+"', '"+("modules/trade/"+d+p+m+"/index.html")+"', '02', 100, '"+i+"', '"+s+"', '1', '0000', '0000', NULL, NULL, NULL, NULL, NULL, NULL, '"+o+"', '1', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, '"+u+"', '"+c+"', NULL, NULL, NULL);",e.menuSqlStr=f,e.dialogVisiable=!0;case 24:case"end":return t.stop()}},t,e)}))()},writeToFile:function(e){var t=e.distTplData,a=e.distTplDataB,r=e.methodsAll,n=e.dataFieldsAll,l={tradeCode:"t"+this.tradeAttrArea.tradeCode,tradeCodeBiz:this.tradeAttrArea.tradeCodeBiz,Author:(this.tradeAttrArea.userName+"   "+this.tradeAttrArea.email).replace(/\n/g,""),time:new Date,tradeName:this.tradeAttrArea.tradeName,groups:t,dataFieldsAll:n,methodsAll:r,tMethods:this.tMethods,tDataFields:this.tDataFields,tableTpls:this.tableTpls,buttomGroup:a},i=window.m,s=i.path,o=i.fs,u=(i.process,i.ejs),c=(window.m.process.cwd(),this.buildPath("src/vue-render/tpls/App.ejs")),d=s.resolve(this.tradeAttrArea.tradeRoot,"modules/trade",this.tradeAttrArea.devGroup,this.tradeAttrArea.devGroupChild,"t"+this.tradeAttrArea.tradeCode);o.mkdirpSync(d);var p=s.resolve(d,"App.vue");console.log(p,"写入成功");var m=o.readFileSync(c,{encoding:"utf-8"}),f=u.render(m,l);o.writeFileSync(p,f,{encoding:"utf-8"});var v=this.buildPath("src/vue-render/tpls/main.ejs"),h=s.resolve(d,"main.js"),b=o.readFileSync(v,{encoding:"utf-8"}),g=u.render(b,{});o.writeFileSync(h,g,{encoding:"utf-8"}),this.$notify({type:"success",title:"成功",message:"写入模板成功"})},tradeRootChange:function(){if(/FCClient$/.test(this.tradeAttrArea.tradeRoot))return window.m.fs.existsSync(this.tradeAttrArea.tradeRoot)?(this.fetchDevGroupOptions(),window.m.store.set("tradeRoot",this.tradeAttrArea.tradeRoot),!0):(this.alert("FCClient项目根目录不存在:"+this.tradeAttrArea.tradeRoot),this.$refs.tradeRoot.focus(),!1);this.alert("必须以FCClient结尾")},getUsernameEmail:function(){var e=this,t=window.m.child_process;t.exec("git config --global user.name",{encoding:"utf-8"},function(t,a,r){var n=a.replace(/[\n\s]/g,"");e.tradeAttrArea.userName=n}),t.exec("git config --global user.email",{encoding:"utf-8"},function(t,a,r){var n=a.replace(/[\n\s]/g,"");e.tradeAttrArea.email=n})},validateForm:function(){var e=this;return new v.a(function(t){e.$refs.titleForm.validate(function(a){var r=e.tradeRootChange();t(a&&r)})})},fetchParaFileOptions:function(){var e=window.m,t=e.fs,a=e.path.resolve(this.tradeAttrArea.tradeRoot,"static/para/selector-config"),r=t.readdirSync(a);r=r.filter(function(e){return/\.json/.test(e)}),this.paraFileOptions=r.map(function(e){return{label:e,value:e}})},paraFileOptionsChange:function(e,t){var a=window.m,r=a.fs,n=a.path,l=t.find(function(e){return"listName"===e.name});if(l){var i=n.resolve(this.tradeAttrArea.tradeRoot,"static/para/selector-config",e),s=r.readFileSync(i),o=m()(JSON.parse(s));l.listNameOptions=o.map(function(e){return{label:e,value:e}}),l.value=""}else console.log("不存在listName",t)},fetchStandardFields:function(){var e=this;return w()(A.a.mark(function t(){return A.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.fetchStandardFields();case 2:e.sent;case 3:case"end":return e.stop()}},t,e)}))()},fetchDevGroupOptions:function(){var e=[],t=window.m,a=t.fs,r=t.path,n=r.resolve(this.tradeAttrArea.tradeRoot,"modules/trade");a.readdirSync(n).forEach(function(t){var l=r.resolve(n,t);a.statSync(l).isDirectory()&&e.push({label:t,value:t})}),this.devGroupOptions=e},devGroupChildBlur:function(){if(this.tradeRootChange()&&(this.tradeAttrArea.devGroupChild="",this.tradeAttrArea.devGroup)){var e=[],t=window.m,a=t.fs,r=t.path,n=r.resolve(this.tradeAttrArea.tradeRoot,"modules/trade",this.tradeAttrArea.devGroup);a.readdirSync(n).forEach(function(t){var l=r.resolve(n,t);a.statSync(l).isDirectory()&&e.push({label:t,value:t})}),this.devGroupOptionsChild=e}},getParentMenuInfo:function(){var e=this;return w()(A.a.mark(function t(){var a;return A.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x.getParentMenuInfo();case 2:if((a=t.sent).isSuccess){t.next=6;break}return e.alert("获取父级餐单失败"),t.abrupt("return");case 6:e.parentMenuOptions=a.data.map(function(e){return{label:e.MENU_NM+"-"+e.MENU_NO,value:e.MENU_NO}});case 7:case"end":return t.stop()}},t,e)}))()}},computed:{},mounted:function(){this.genStandardField(),this.getUsernameEmail(),window.m.store.has("tradeRoot")&&(this.tradeAttrArea.tradeRoot=window.m.store.get("tradeRoot")),this.getParentMenuInfo()}},I={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"GenTrade"},[a("el-divider",{attrs:{"content-position":"left"}},[e._v("交易属性")]),e._v(" "),a("el-form",{ref:"titleForm",attrs:{model:e.tradeAttrArea,"label-width":"130px",size:"mini"}},[a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"FCClient路径",rules:e.titleRule,prop:"tradeRoot"}},[a("el-input",{ref:"tradeRoot",on:{change:e.tradeRootChange},model:{value:e.tradeAttrArea.tradeRoot,callback:function(t){e.$set(e.tradeAttrArea,"tradeRoot",t)},expression:"tradeAttrArea.tradeRoot"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"开发组",rules:e.titleRule,prop:"devGroup"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:"请选择"},on:{focus:e.devGroupChildBlur,change:e.devGroupChildBlur},model:{value:e.tradeAttrArea.devGroup,callback:function(t){e.$set(e.tradeAttrArea,"devGroup",t)},expression:"tradeAttrArea.devGroup"}},e._l(e.devGroupOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"子目录",prop:"devGroupChild"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:"请选择"},model:{value:e.tradeAttrArea.devGroupChild,callback:function(t){e.$set(e.tradeAttrArea,"devGroupChild",t)},expression:"tradeAttrArea.devGroupChild"}},e._l(e.devGroupOptionsChild,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"交易名称",rules:e.titleRule,prop:"tradeName"}},[a("el-input",{model:{value:e.tradeAttrArea.tradeName,callback:function(t){e.$set(e.tradeAttrArea,"tradeName",t)},expression:"tradeAttrArea.tradeName"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"开发者",rules:e.titleRule,prop:"userName"}},[a("el-input",{model:{value:e.tradeAttrArea.userName,callback:function(t){e.$set(e.tradeAttrArea,"userName",t)},expression:"tradeAttrArea.userName"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"邮件",rules:e.titleRule,prop:"email"}},[a("el-input",{model:{value:e.tradeAttrArea.email,callback:function(t){e.$set(e.tradeAttrArea,"email",t)},expression:"tradeAttrArea.email"}})],1)],1)],1),e._v(" "),a("el-divider",{attrs:{"content-position":"left"}},[e._v("菜单属性")]),e._v(" "),a("el-row",[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"菜单位置",rules:e.titleRule,prop:"menuPosition"}},[a("el-select",{staticStyle:{width:"100%"},model:{value:e.tradeAttrArea.menuPosition,callback:function(t){e.$set(e.tradeAttrArea,"menuPosition",t)},expression:"tradeAttrArea.menuPosition"}},[a("el-option",{attrs:{label:"客户服务",value:"001"}}),e._v(" "),a("el-option",{attrs:{label:"内部服务",value:"002"}})],1)],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"6位交易码",rules:e.titleRule,prop:"tradeCodeBiz"}},[a("el-input",{model:{value:e.tradeAttrArea.tradeCodeBiz,callback:function(t){e.$set(e.tradeAttrArea,"tradeCodeBiz",t)},expression:"tradeAttrArea.tradeCodeBiz"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"8位交易码",rules:e.titleRule,prop:"tradeCode"}},[a("el-input",{model:{value:e.tradeAttrArea.tradeCode,callback:function(t){e.$set(e.tradeAttrArea,"tradeCode",t)},expression:"tradeAttrArea.tradeCode"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"父级菜单",rules:e.titleRule,prop:"parentMenu"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:""},model:{value:e.tradeAttrArea.parentMenu,callback:function(t){e.$set(e.tradeAttrArea,"parentMenu",t)},expression:"tradeAttrArea.parentMenu"}},e._l(e.parentMenuOptions,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"菜单icon",rules:e.titleRule,prop:"menuIcon"}},[a("el-select",{staticStyle:{width:"100%"},model:{value:e.tradeAttrArea.menuIcon,callback:function(t){e.$set(e.tradeAttrArea,"menuIcon",t)},expression:"tradeAttrArea.menuIcon"}},e._l(e.iconsOptions,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"是否可见",rules:e.titleRule,prop:"visiable"}},[a("el-select",{staticStyle:{width:"100%"},model:{value:e.tradeAttrArea.visiable,callback:function(t){e.$set(e.tradeAttrArea,"visiable",t)},expression:"tradeAttrArea.visiable"}},[a("el-option",{attrs:{label:"是",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"否",value:"0"}})],1)],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"签到可见",rules:e.titleRule,prop:"signVisiable"}},[a("el-select",{staticStyle:{width:"100%"},model:{value:e.tradeAttrArea.signVisiable,callback:function(t){e.$set(e.tradeAttrArea,"signVisiable",t)},expression:"tradeAttrArea.signVisiable"}},[a("el-option",{attrs:{label:"是",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"否",value:"0"}})],1)],1)],1)],1)],1),e._v(" "),a("el-row",[a("el-button",{attrs:{type:"primary",icon:"el-icon-document"},on:{click:e.genTradeTpl}},[e._v("生成交易")]),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-document"},on:{click:e.gentTradeMenu}},[e._v("生成菜单sql")]),e._v(" "),a("el-button",{attrs:{icon:"el-icon-upload2"},on:{click:e.chooseExcel}},[e._v("导入交易统计excel")]),e._v(" "),a("el-button",{attrs:{icon:"el-icon-download"},on:{click:e.saveTmpExcel}},[e._v("生成交易统计模板excel")])],1),e._v(" "),a("el-divider",{attrs:{"content-position":"left"}},[e._v("交易内容")]),e._v(" "),a("div",[a("el-form",{ref:"form",attrs:{"label-width":"80px",size:"mini"}},[a("div",{staticClass:"groups"},[a("el-collapse",{model:{value:e.collapseValues,callback:function(t){e.collapseValues=t},expression:"collapseValues"}},e._l(e.excelDataRender,function(t,r){return a("div",{key:r,staticClass:"group"},[a("el-collapse-item",{attrs:{name:t.label}},[a("template",{slot:"title"},[a("span",[e._v("组："+e._s(t.groupTitle))]),e._v(" "),a("span",{staticStyle:{"margin-left":"30px"}},[e._v("栏位："+e._s(t.label))])]),e._v(" "),a("el-row",e._l(t.compAttr,function(r,n){return a("div",{key:n},[a("el-col",{attrs:{span:6}},["paraFile"==r.name?[a("el-form-item",{attrs:{label:r.name,rules:e.rules}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",filterable:""},on:{change:function(a){return e.paraFileOptionsChange(r.value,t.compAttr)}},model:{value:r.value,callback:function(t){e.$set(r,"value",t)},expression:"compo.value"}},e._l(e.paraFileOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)]:"listName"==r.name?[a("el-form-item",{attrs:{label:r.name,rules:e.rules}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",filterable:""},model:{value:r.value,callback:function(t){e.$set(r,"value",t)},expression:"compo.value"}},e._l(r.listNameOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)]:[a("el-form-item",{attrs:{label:r.name,rules:e.rules}},[a("input",{directives:[{name:"model",rawName:"v-model",value:r.value,expression:"compo.value"}],staticStyle:{width:"100%"},domProps:{value:r.value},on:{input:function(t){t.target.composing||e.$set(r,"value",t.target.value)}}})])]],2)],1)}),0)],2)],1)}),0)],1)])],1),e._v(" "),a("input",{ref:"inputFile",staticStyle:{display:"none"},attrs:{type:"file"},on:{change:e.inputFileChange}}),e._v(" "),a("el-dialog",{attrs:{visible:e.dialogVisiable,title:"菜单sql","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.dialogVisiable=t}}},[a("h3",[e._v("生成菜单sql")]),e._v(" "),a("el-input",{attrs:{autosize:{minRows:10,maxRows:100},type:"textarea"},model:{value:e.menuSqlStr,callback:function(t){e.menuSqlStr=t},expression:"menuSqlStr"}})],1)],1)},staticRenderFns:[]};var B=a("C7Lr")(M,I,!1,function(e){a("DW1S")},"data-v-bda2bace",null).exports,G=a("IHPB"),U=a.n(G),q={name:"GenPrintF",components:{},props:{},data:function(){return{labelWidth:"17.5",tradeRoot:"E:\\work\\zantong\\qdgz_TEClient\\FCClient",fTableName:"xxx.aft",config:"IMEI序列号|SIM卡序列号|保证金金额|保证金账号|保证金账户标志|IMEI序列号,SIM卡序列号|保证金金额,保证金账号,保证金账户标志",title:"无标题",standardField:[{label:"账号",value:"acc"},{label:"客户姓名",value:"custName"},{label:"性别",value:"sex"}],fields:[],tables:[]}},methods:{parseFields:function(){var e=this;return w()(A.a.mark(function t(){var a,r,n,l,i,s;return A.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.checkPath();case 2:if(t.sent){t.next=5;break}return t.abrupt("return");case 5:if(a=e.config.split("|").map(function(e){return e.replace(/[\s\t\n]/g,"")}).filter(function(e){return e}),r=a.filter(function(e){return!/[,，]/.test(e)}),n=(n=a.filter(function(e){return/[,，]/.test(e)})).map(function(e){return e.split(/[,，]/g)}),l=[].concat(U()(r)),n.forEach(function(e){e=e.filter(function(e){return e}),l=l.concat(e)}),0==(i=e.checkFields(l)).length){t.next=16;break}return s=i.join(" "),e.alert(s,"以下字段在标准库中不存在，联系标准组添加后继续生成F表"),t.abrupt("return");case 16:e.fields=r.map(function(t){return{label:t=t.replace(/[\s\t\n]/g,""),value:e.findEnField(t)}}),e.tables=n.map(function(t){return t.map(function(t){return{label:t=t.replace(/[\s\t\n]/g,""),value:e.findEnField(t)}})}),e.genFtableXml(e.fields,e.tables);case 19:case"end":return t.stop()}},t,e)}))()},checkFields:function(e){for(var t=this,a=[],r=function(r){t.standardField.find(function(t){return t.label==e[r]})||a.push(e[r])},n=0;n<e.length;n++)r(n);return a},findEnField:function(e){return this.standardField.find(function(t){return t.label==e}).value},checkPath:function(){var e=this;return w()(A.a.mark(function t(){var a,r;return A.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.fTableName.trim()){t.next=3;break}return e.alert("f表名称不能为空"),t.abrupt("return",!1);case 3:if(e.config){t.next=6;break}return e.alert("F表字段不能为空"),t.abrupt("return",!1);case 6:if(!window.m.fs.existsSync(e.tradeRoot)){t.next=12;break}window.m.store.set("tradeRoot",e.tradeRoot),t.next=14;break;case 12:return e.alert("项目路径不存在\n"+e.tradeRoot),t.abrupt("return");case 14:if(a=window.m.path.resolve(e.tradeRoot,"print"),window.m.fs.existsSync(a)){t.next=19;break}return e.alert("目录"+a+"不存在"),t.abrupt("return",!1);case 19:if(r=window.m.path.resolve(a,e.fTableName),!window.m.fs.existsSync(r)){t.next=32;break}return t.next=24,e.alert("文件f表"+r+"已存在是否覆盖？");case 24:if(!t.sent){t.next=29;break}return t.abrupt("return",!0);case 29:return t.abrupt("return",!1);case 30:t.next=33;break;case 32:return t.abrupt("return",!0);case 33:case"end":return t.stop()}},t,e)}))()},transformFields:function(e){for(var t=[],a=0;a<e.length;a++){var r=e[a];if(0==t.length)t.push([r]);else{var n=t[t.length-1];if(1==n.length){n.push(r);continue}2==n.length&&t.push([r])}}return t},genFtableXml:function(e,t){var a=this;return w()(A.a.mark(function r(){var n,l,i,s,o,u,c,d,p,m;return A.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:n=window.m,l=n.path,i=n.fs,n.process,s=n.ejs,o=a.transformFields(e),console.log("this.groups",b()(o)),console.log("this.tables",b()(t)),u={title:a.title,groups:o,tables:t,labelWidth1:a.labelWidth},c=a.buildPath("src/vue-render/tpls/aft.ejs"),d=i.readFileSync(c,{encoding:"utf-8"}),p=s.render(d,u),m=l.resolve(a.tradeRoot,"print",a.fTableName),console.log("生成F表：",m),i.writeFileSync(m,p,{encoding:"utf-8"}),a.alert("生成F表成功\n"+m);case 12:case"end":return r.stop()}},r,a)}))()},queryAllStandardFields:function(){var e=this;return w()(A.a.mark(function t(){var a;return A.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x.queryAllStandardFields();case 2:if((a=t.sent).isSuccess){t.next=6;break}return e.alert("获取标准字段出错"),t.abrupt("return");case 6:e.standardField=a.data;case 7:case"end":return t.stop()}},t,e)}))()}},watch:{},filters:{},mounted:function(){this.queryAllStandardFields(),window.m.store.has("tradeRoot")&&(this.tradeRoot=window.m.store.get("tradeRoot"))}},V={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"GenPrintF"},[a("el-form",{ref:"form",attrs:{"label-width":"130px",size:"mini"}},[a("el-form-item",{attrs:{label:"FCClient路径："}},[a("el-input",{staticStyle:{width:"100%"},model:{value:e.tradeRoot,callback:function(t){e.tradeRoot=t},expression:"tradeRoot"}})],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"F表文件名："}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"00101001.aft"},model:{value:e.fTableName,callback:function(t){e.fTableName=t},expression:"fTableName"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"F表标题："}},[a("el-input",{staticStyle:{width:"100%"},model:{value:e.title,callback:function(t){e.title=t},expression:"title"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"中文字段宽度："}},[a("el-input",{staticStyle:{width:"100%"},model:{value:e.labelWidth,callback:function(t){e.labelWidth=t},expression:"labelWidth"}})],1)],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"F表字段："}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:10,maxRows:40},placeholder:"\n      输入字段格式:账号|客户姓名|性别|账户类型\n      如果为表格则逗号隔开:性别,账号,客户姓名\n      如果有字段和表格则:账号|客户姓名|性别|性别,账号,客户姓名"},model:{value:e.config,callback:function(t){e.config=t},expression:"config"}})],1)],1),e._v(" "),a("el-row",[a("el-button",{attrs:{type:"primary"},on:{click:e.parseFields}},[e._v("生成F表")])],1)],1)},staticRenderFns:[]};var $=a("C7Lr")(q,V,!1,function(e){a("fqpY")},"data-v-3c81c7a2",null).exports,W=window.m.xlsx,Y={name:"GenInterface",components:{},props:{},data:function(){return{}},methods:{selectExcel:function(){this.$refs.inputFile.value="",this.$refs.inputFile.click()},transform:function(){},inputFileChange:function(e){var t=this;return w()(A.a.mark(function a(){var r,n,l,i,s,o,u,c,d,p,m,f,v,h,b;return A.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(r=window.m,n=r.fs,l=r.path,i=e.target.files[0],s=i.path,window.m.path.basename(s),o=window.m.path.extname(i.path),u=l.parse(s),c=u.dir,d=u.ext,p=u.name,m=l.resolve(c,p+"_"+Date.now()+d),[".xls",".xlsx"].includes(o)){a.next=10;break}return t.$notify({message:"必须是excel"}),a.abrupt("return");case 10:return a.next=12,L.readExcelAsync(i);case 12:return f=a.sent,v=f.data,h=n.readFileSync(s),b=W.read(h,{type:"array"}),a.next=18,t.genNewExcel(v,b,m);case 18:case"end":return a.stop()}},a,t)}))()},genNewExcel:function(e,t,a){var r=this;return w()(A.a.mark(function n(){var l;return A.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r.genStyle(t),n.next=3,r.handleData(e,t);case 3:if(n.sent){n.next=6;break}return n.abrupt("return");case 6:l=W.write(t,{type:"buffer",bookType:"xlsx"}),fs.writeFileSync(a,l),r.alert("成功生成文件"+a,"成功");case 9:case"end":return n.stop()}},n,r)}))()},genStyle:function(e){var t=[{wch:20},{wch:20},{wch:20},{wch:8},{wch:8},{wch:3},{wch:20},{wch:20},{wch:20},{wch:20},{wch:20},{wch:20},{wch:20}],a=new Array(20).fill(1).map(function(e){return{wch:20}}),r=e.Sheets;for(var n in r)r[n]["!cols"]="INDEX"==n?a:t},handleData:function(e,t){var a=this;return w()(A.a.mark(function r(){var n,l,i,s,o,u,c,d,p,m,f,v;return A.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:n=[],l={},r.t0=A.a.keys(e);case 3:if((r.t1=r.t0()).done){r.next=24;break}if("INDEX"!=(i=r.t1.value)){r.next=7;break}return r.abrupt("continue",3);case 7:l[i]||(l[i]={}),s=e[i],o=0;case 10:if(!(o<s.length)){r.next=22;break}if(u=s[o],!String(u.B).trim()){r.next=19;break}if(c="G"+(o+1),!(o>5)){r.next=19;break}return r.next=17,a.findEnField(u.B,n);case 17:d=r.sent,l[i][c]=d;case 19:o++,r.next=10;break;case 22:r.next=3;break;case 24:for(p in l)for(m in l[p])(f=t.Sheets[p][m])&&(f.v=l[p][m]);return 0!=n.length&&(v=n.map(function(e){return'<span style="margin-left:5px;">'+e+"</span>"}).join(""),a.alert(v,"以下字段联系标准组添加后再生成接口")),r.abrupt("return",0==n.length);case 27:case"end":return r.stop()}},r,a)}))()},findEnField:function(e){var t=this;arguments.length>1&&void 0!==arguments[1]&&arguments[1];return w()(A.a.mark(function a(){return A.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!["中文名称"].includes(e)){t.next=3;break}return t.abrupt("return","");case 3:return t.abrupt("return","test_field");case 4:case"end":return t.stop()}},a,t)}))()}},watch:{},filters:{},mounted:function(){}},H={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"GenInterface"},[t("el-divider",{attrs:{"content-position":"left"}},[this._v("操作区")]),this._v(" "),t("el-row",[t("el-button",{attrs:{type:"primary",icon:"el-icon-upload2"},on:{click:this.selectExcel}},[this._v("选择需要转换的接口excel")])],1),this._v(" "),t("input",{ref:"inputFile",staticStyle:{display:"none"},attrs:{type:"file"},on:{change:this.inputFileChange}})],1)},staticRenderFns:[]};var z=a("C7Lr")(Y,H,!1,function(e){a("NqFX")},"data-v-513705ff",null).exports;r.default.use(u.a);var j=new u.a({routes:[{path:"/",name:"Home",redirect:"/GenTrade",component:d},{path:"/GenTrade",name:"GenTrade",component:B},{path:"/GenPrintF",name:"GenPrintF",component:$},{path:"/GenInterface",name:"GenInterface",component:z}]}),Q=(a("0CLL"),a("09yM"),a("TcQY")),J=a.n(Q),K=(a("+hAf"),{methods:{success:function(e,t){return{isSuccess:!0,msg:t||"",data:e||{}}},fail:function(e,t){return{isSuccess:!1,msg:t||"",data:e||{}}},alert:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new v.a(function(r){e.$alert(t,a,{dangerouslyUseHTMLString:!0,closeOnPressEscape:!1,closeOnClickModal:!1}).then(function(e){return r(!0)}).catch(function(e){return r(!1)})})},repeat:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"\t").repeat(e)},buildPath:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=window.m,a=t.isDev,r=t.path,n=(t.process,window.m.process.cwd());return a?r.resolve(n,e):r.resolve(n,"resources/app/",e)}},mounted:function(){(window.comps||(window.comps={}))[this.$options.name||"anonymous"]=this}});r.default.use(J.a,{size:"small",zIndex:3e3}),r.default.config.productionTip=!1,r.default.mixin(K),new r.default({el:"#app",router:j,components:{App:o},template:"<App/>"})},NqFX:function(e,t){},fqpY:function(e,t){},iWT2:function(e,t){},yfIn:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.js.map